{% extends "base.html" %}

{% block title %}Manage Feed Stock{% endblock %}

{% block content %}
<div class="container my-5">
    <h2 class="mb-4">Manage Feed Stock</h2>
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}

    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-body">
                    <h5 class="card-title">{% if feed_item %}Update Feed Stock{% else %}Add New Feed Stock{% endif %}</h5>
                    <form method="post" action="{% if feed_item %}{% url 'update_feed_stock' feed_item.pk %}{% else %}{% url 'manage_feed_stock' %}{% endif %}" class="mt-3">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="name" name="name" value="{% if feed_item %}{{ feed_item.name }}{% endif %}" required>
                        </div>
                        <div class="mb-3">
                            <label for="feed_type" class="form-label">Feed Type</label>
                            <input type="text" class="form-control" id="feed_type" name="feed_type" value="{% if feed_item %}{{ feed_item.feed_type }}{% endif %}" required>
                        </div>
                        <div class="mb-3">
                            <label for="feed_brand" class="form-label">Feed Brand</label>
                            <input type="text" class="form-control" id="feed_brand" name="feed_brand" value="{% if feed_item %}{{ feed_item.feed_brand }}{% endif %}">
                        </div>
                        <div class="mb-3">
                            <label for="quantity" class="form-label">Quantity</label>
                            <input type="number" class="form-control" id="quantity" name="quantity" min="0" value="{% if feed_item %}{{ feed_item.quantity }}{% endif %}" required>
                        </div>
                        <div class="mb-3">
                            <label for="unit_price" class="form-label">Unit Price (UGX)</label>
                            <input type="number" class="form-control" id="unit_price" name="unit_price" min="0" step="any" value="{% if feed_item %}{{ feed_item.unit_price }}{% endif %}" required>
                        </div>
                        <div class="mb-3">
                            <label for="buying_price" class="form-label">Buying Price (UGX)</label>
                            <input type="number" class="form-control" id="buying_price" name="buying_price" min="0" step="any" value="{% if feed_item %}{{ feed_item.buying_price }}{% endif %}">
                        </div>
                        <div class="mb-3">
                            <label for="selling_price" class="form-label">Selling Price (UGX)</label>
                            <input type="number" class="form-control" id="selling_price" name="selling_price" min="0" step="any" value="{% if feed_item %}{{ feed_item.selling_price }}{% endif %}">
                        </div>
                        <div class="mb-3">
                            <label for="supplier" class="form-label">Supplier</label>
                            <input type="text" class="form-control" id="supplier" name="supplier" value="{% if feed_item %}{{ feed_item.supplier }}{% endif %}">
                        </div>
                        <div class="mb-3">
                            <label for="supplier_contact" class="form-label">Supplier Contact</label>
                            <input type="text" class="form-control" id="supplier_contact" name="supplier_contact" value="{% if feed_item %}{{ feed_item.supplier_contact }}{% endif %}">
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">{% if feed_item %}Update{% else %}Add{% endif %}</button>
                        </div>
                    </form>
                    {% if feed_item %}
                    <form method="post" action="{% url 'update_feed_stock' feed_item.pk %}" class="d-grid mt-2">
                        {% csrf_token %}
                        <button type="submit" name="delete" class="btn btn-danger">Delete</button>
                    </form>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-body">
                    <h5 class="card-title">Current Feed Stock</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Quantity</th>
                                    <th>Unit Price</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for feed in feeds %}
                                <tr>
                                    <td>{{ feed.name }}</td>
                                    <td>{{ feed.feed_type }}</td>
                                    <td>{{ feed.quantity }}</td>
                                    <td>UGX {{ feed.unit_price }}</td>
                                    <td>
                                        <a href="{% url 'feed_stock_update' feed.pk %}" class="btn btn-sm btn-info">Edit</a>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="text-center">No feed stock available.</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
